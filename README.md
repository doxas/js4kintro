#js4kintro

javascript と WebGL、そして GLSL を用いて行う 4k イントロのためのひな形ファイルです。

現状ではベースファイルの容量が約 1.4 キロバイトになっています。工夫次第で約 2.6 キロバイトほどフラグメントシェーダのコードが書けるはずです。

基本的な仕様は以下参照。

* ブラウザのクライアント領域全面に canvas を配置
* canvas サイズ及び viewport もクライアント領域に合わせて動的に書き換え
* window.onload で動作開始、ESC キーによって動作を停止
* アニメーションは setTimeout を利用しており更新頻度は 16ms を指定
* シェーダのコンパイルとリンクをチェックしておりエラーがある場合には動作しない
* 極力ブラウザの違いによって動作に差がでないように WebGL 本体部分を設計


##ルール(仮)

* ファイルサイズが 4096 バイト以下
* オフラインで動作する
* HTML には最終的にタイトル(titleタグ)を含めるがこれはファイルサイズにカウントしない
* HTML、javascript、または css を現状よりも minify する場合には pull request(全員が同じひな形を使えるようにするため)
* サウンド処理を追加するなどの特別な事情があり js 等に **追記するのは** OK
* ただし、js や css に手を入れた場合は理由と共に明文化する
* 最低でも 512px 以上の矩形領域で動作することを保証


##書いてみたくなったら

src フォルダには、一切省略せずに記述した full 版と通常版のファイルが入っています。

それぞれに、デバッグ用のコードを追加したバージョンが付随します。コードを自分で書いていく際は、初期段階は full_debug.html を用いてどんどんコードを書き、ある程度コードが仕上がってきて最適化する段階になったら index_debug.html で試してみておおよそサイズが 4k に収まるのかどうか調べてみるのがいいのではないでしょうか。

尚、full 版にはプリセットのフラグメントシェーダのコードとして、ジュリア集合を描くことができるサンプルが入っています。

index.html 及び index_debug.html の両者にはフラグメントシェーダの uniform 宣言の部分までしか入っていないので、なにかしら中身を入れないと動きません。

オンラインで GLSL のコードを最適化してくれる[GLSL Compiler](http://glslunit.appspot.com/compiler.html)なるサイトもありますが、どうやら余計なスペースなどを消してくれるだけのようです。コードが巨大であれば手間の軽減にはなるかもしれません。


##今後の見通し

本企画はいずれちゃんとした形で投稿型イベントとして開催したいと考えています。


##動作環境の問題

ひとつの基準として、MacBookAir(1.4GHzデュアルコアIntel Core i5+Intel HD Graphics 5000+メモリ8MB+13.3インチ)で普通に動くかどうか。

3DMark FireStrike でスコア 1000 位のマシンで平常運転できるかどうかくらいが目安になりそうな気がする。

ちなみに、MacBookAir 2014 モデルの上記構成とほぼ同じものが FireStrike のスコアとして 700～800 前後だと思われます。
